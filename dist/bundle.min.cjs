var b=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var T=(n,l)=>{for(var e in l)b(n,e,{get:l[e],enumerable:!0})},j=(n,l,e,i)=>{if(l&&typeof l=="object"||typeof l=="function")for(let o of B(l))!F.call(n,o)&&o!==e&&b(n,o,{get:()=>l[o],enumerable:!(i=M(l,o))||i.enumerable});return n};var k=n=>j(b({},"__esModule",{value:!0}),n);var w={};T(w,{Shual:()=>x});module.exports=k(w);var r=require("@yaronkoresh/math"),x=function(n,l,e=8,i=8){if((0,r.Greater)(i,0)!==i.toString())return console.error("Length must be one or above!"),null;if(i=parseInt(i),(0,r.Greater)(e,0)!==e.toString())return console.error("Strength must be one or above!"),null;if(e=parseInt(e),i>parseInt(e))return console.error("Strength must be greater than length!"),null;if(e*=100,n.length===0)return console.error("Password is invalid"),null;if(l.length===0)return console.error("Salt is invalid"),null;let o=(0,r.StringToBytes)(n),d=(0,r.StringToBytes)(l),v=+(0,r.Add)(o,0),A=+(0,r.Add)(d,0),u=o.length%e,s=d.length%e,p=(v+s)%e,f=(A+u)%e;u=(s+p)%e,s=(s+f)%e,p=(u+p)%e,f=(u+f)%e;let m=[],I=0;for(let c=i;c>0;c--){for(let t=o.length;t>0;t--)for(let a=d.length;a>0;a--){let y=u;u=parseInt(parseInt(s)+c+t+o[t-1]+d[a-1])%e,s=parseInt(parseInt(p)+c+a+o[t-1]+d[a-1])%e,p=parseInt(parseInt(f)+t+a+o[t-1]+d[a-1])%e,f=parseInt(parseInt(y)+c+t+a+o[t-1]+d[a-1])%e,I=+(0,r.Add)(I,c,t,a,u,s,p,f),I=+(0,r.Mod)(I,e),I=+(0,r.Add)(I,100)}u%=16+1,s%=16+1,p%=16+1,f%=16+1;let S=[...(0,r.Fibonacci)(I)].reverse();S=S[0].charAt(u)+S[1].charAt(s)+S[2].charAt(p)+S[3].charAt(f),m[c-1]=+S}return m=m.map(c=>c%95+32),(0,r.BytesToString)(m)};0&&(module.exports={Shual});
