var S=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var w=(o,i)=>{for(var l in i)S(o,l,{get:i[l],enumerable:!0})},G=(o,i,l,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of B(i))!F.call(o,n)&&n!==l&&S(o,n,{get:()=>i[n],enumerable:!(s=y(i,n))||s.enumerable});return o};var L=o=>G(S({},"__esModule",{value:!0}),o);var Z={};w(Z,{Shual:()=>M});module.exports=L(Z);var t=require("@yaronkoresh/math"),M=function(o,i,l=8){if(l=l.toString(),(0,t.Greater)(l,0)!==l)return console.error("The Length must be one or above!"),null;if(l=(0,t.Multiply)(l,3),o.length===0)return console.error("The selected password is invalid"),null;if(i.length===0)return console.error("The selected salt is invalid"),null;let s=(0,t.StringToBytes)(o),n=(0,t.Add)(s,0),u=(0,t.StringToBytes)(i),T=(0,t.Add)(u,0),f=128,b=[],k=0;for(let e=s[0];e<l*2+s[0];e+=2)for(let r=0;r<s.length*3;r+=3){let c=(s.length+r)%8,h=(n+r)%7,d=Math.abs(c+h-e)%8,m=Math.abs((d+1)*2)%7;f=(0,t.Add)((0,t.Mod)((0,t.Add)(f,r,e,1,c,h,d,m),96),96);let p=[...(0,t.Fibonacci)(f)].reverse().slice(0,64).map(a=>[a.charAt(c),a.charAt(h),a.charAt(d),a.charAt(m)]).flat(),A=s[r/3]%256,v=p[A];b[e]=(b[e]??0)+v,b[e]%=10}b=b.join("");let g=[],q=0;for(let e=u[0];e<l*3+u[0];e+=3)for(let r=0;r<u.length*2;r+=2){let c=(u.length+r)%8,h=(T+r)%7,d=Math.abs(c+h-e)%8,m=Math.abs((d+1)*2)%7;f=(0,t.Add)((0,t.Mod)((0,t.Add)(f,r,e,1,c,h,d,m),96),96);let p=[...(0,t.Fibonacci)(f)].reverse().slice(0,64).map(a=>[a.charAt(c),a.charAt(h),a.charAt(d),a.charAt(m)]).flat(),A=u[r/2]%256,v=p[A];g[e]=(g[e]??0)+v,g[e]%=10}g=g.join("");let x=(0,t.Zeros)((0,t.Add)(b,g),l);x=x.slice(x.length-l);let j=(0,t.Split)(x,3).map(e=>(0,t.Add)((0,t.Mod)((0,t.Add)(e,0),95),32));return(0,t.BytesToString)(j)};0&&(module.exports={Shual});
