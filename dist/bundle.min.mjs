import{Greater as x,Mod as j,Add as d,StringToBytes as b,Fibonacci as M}from"@yaronkoresh/math";var B=function(I,S,o=1,f=64){if(x(f,0)!==f.toString())return console.error("Length must be one or above!"),null;if(f=parseInt(f),x(o,0)!==o.toString())return console.error("Strength must be one or above!"),null;if(o=parseInt(o),o-=1,o*=1e3,o+=10,I.length===0)return console.error("Password is invalid"),null;if(S.length===0)return console.error("Salt is invalid"),null;let c=b(I),u=b(S),A=+d(c,0),v=+d(u,0),e=c.length%o,n=u.length%o,i=(A+n)%o,t=(v+e)%o;e=(n+i)%o,n=(n+t)%o,i=(e+i)%o,t=(e+t)%o;let F=[],m=[],a=0;for(let p=f;p>0;p--){for(let r=c.length;r>0;r--)for(let l=u.length;l>0;l--){let y=e;e=parseInt(parseInt(n)+p+r+c[r-1]+u[l-1])%o,n=parseInt(parseInt(i)+p+l+c[r-1]+u[l-1])%o,i=parseInt(parseInt(t)+r+l+c[r-1]+u[l-1])%o,t=parseInt(parseInt(y)+p+r+l+c[r-1]+u[l-1])%o,a=+d(a,p,r,l,e,n,i,t),o+=1,a=+j(a,o),e=a,a=+d(a,100)}e%=16+1,n%=16+1,i%=16+1,t%=16+1;let s=[...M(a)].reverse();s=parseInt([s[0].charAt(e),s[1].charAt(n),s[2].charAt(i),s[3].charAt(t)].join(""))%26+65,m[p-1]=String.fromCodePoint(s)}return"SHUAL:"+S+":"+m.join("")};export{B as Shual};
