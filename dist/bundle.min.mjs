import{Multiply as B,Greater as F,Mod as p,Zeros as w,Add as i,StringToBytes as S,BytesToString as G,Split as L,Fibonacci as M}from"@yaronkoresh/math";var Z=function(A,v,l=8){if(l=l.toString(),F(l,0)!==l)return console.error("The Length must be one or above!"),null;if(l=B(l,3),A.length===0)return console.error("The selected password is invalid"),null;if(v.length===0)return console.error("The selected salt is invalid"),null;let n=S(A),T=i(n,0),c=S(v),j=i(c,0),h=128,d=[],k=0;for(let t=n[0];t<l*2+n[0];t+=2)for(let e=0;e<n.length*3;e+=3){let o=(n.length+e)%8,s=(T+e)%7,a=Math.abs(o+s-t)%8,f=Math.abs((a+1)*2)%7;h=i(p(i(h,e,t,1,o,s,a,f),96),96);let g=[...M(h)].reverse().slice(0,64).map(r=>[r.charAt(o),r.charAt(s),r.charAt(a),r.charAt(f)]).flat(),m=n[e/3]%256,x=g[m];d[t]=(d[t]??0)+x,d[t]%=10}d=d.join("");let u=[],q=0;for(let t=c[0];t<l*3+c[0];t+=3)for(let e=0;e<c.length*2;e+=2){let o=(c.length+e)%8,s=(j+e)%7,a=Math.abs(o+s-t)%8,f=Math.abs((a+1)*2)%7;h=i(p(i(h,e,t,1,o,s,a,f),96),96);let g=[...M(h)].reverse().slice(0,64).map(r=>[r.charAt(o),r.charAt(s),r.charAt(a),r.charAt(f)]).flat(),m=c[e/2]%256,x=g[m];u[t]=(u[t]??0)+x,u[t]%=10}u=u.join("");let b=w(i(d,u),l);b=b.slice(b.length-l);let y=L(b,3).map(t=>i(p(i(t,0),95),32));return G(y)};export{Z as Shual};
