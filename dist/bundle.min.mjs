import{Greater as b,Mod as M,Add as I,StringToBytes as x,BytesToString as B,Fibonacci as F}from"@yaronkoresh/math";var T=function(S,m,e=8,p=8){if(b(p,0)!==p.toString())return console.error("Length must be one or above!"),null;if(p=parseInt(p),b(e,0)!==e.toString())return console.error("Strength must be one or above!"),null;if(e=parseInt(e),p>parseInt(e))return console.error("Strength must be greater than length!"),null;if(e*=100,S.length===0)return console.error("Password is invalid"),null;if(m.length===0)return console.error("Salt is invalid"),null;let u=x(S),s=x(m),v=+I(u,0),A=+I(s,0),l=u.length%e,n=s.length%e,a=(v+n)%e,i=(A+l)%e;l=(n+a)%e,n=(n+i)%e,a=(l+a)%e,i=(l+i)%e;let d=[],c=0;for(let t=p;t>0;t--){for(let r=u.length;r>0;r--)for(let o=s.length;o>0;o--){let y=l;l=parseInt(parseInt(n)+t+r+u[r-1]+s[o-1])%e,n=parseInt(parseInt(a)+t+o+u[r-1]+s[o-1])%e,a=parseInt(parseInt(i)+r+o+u[r-1]+s[o-1])%e,i=parseInt(parseInt(y)+t+r+o+u[r-1]+s[o-1])%e,c=+I(c,t,r,o,l,n,a,i),c=+M(c,e),c=+I(c,100)}l%=16+1,n%=16+1,a%=16+1,i%=16+1;let f=[...F(c)].reverse();f=f[0].charAt(l)+f[1].charAt(n)+f[2].charAt(a)+f[3].charAt(i),d[t-1]=+f}return d=d.map(t=>t%95+32),B(d)};export{T as Shual};
